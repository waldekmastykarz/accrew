#!/bin/sh
# Auto-install dependencies when package-lock.json changes after a pull/merge.
# WHY: Dependabot (and other CI) updates package.json + lock file via PRs.
# After merging/pulling, node_modules becomes stale. This hook detects lock file
# changes and runs npm install + postinstall automatically.

changed_files="$(git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD)"

if echo "$changed_files" | grep -q "package-lock.json"; then
  echo "ðŸ“¦ package-lock.json changed â€” running npm install..."
  npm install
  echo "âœ… Dependencies synced."
fi
